# 프리코스 3주차 : 블랙잭 게임



## 1. 프로그램 개요



### 게임 개요

이 프로그램은 총 52장의 플레잉 카드(트럼프 카드)를 통해 진행하는 **블랙잭** 카드 게임 이다.

블랙잭 게임은 한 명의 딜러와 여러 명(*최대 제한 없음*)의 플레이어가 참가하며,

카드 여러 장을 뽑아 그 숫자의 합이 21점에 가까운 사람이 이기는 게임이다.

이때, ACE(1) 카드는 1점과 11점 중 더 유리한 수로 계산할 수 있고,

나머지 카드는 자신의 번호를 점수로 계산하며,

King,Queen,Jack은 10으로 계산한다.



### 플레이어

게임을 시작하면 각 플레이어는 2장의 카드를 지급받는다.

만약 패의 합이 21점을 넘지 않는다면, 플레이어는 원하는 만큼 카드를 더 뽑을 수 있다.

다음은 플레이어의 **승리 조건**이다.

- 처음 두 장의 합이 21점이 나오는 경우
- 패의 합이 21점을 넘지 않고, 딜러보다 패의 합이 큰 경우
- 딜러의 패가 21점을 넘긴 경우

다음은 플레이어의 **무승부 조건**이다.

- 딜러와 플레이어 모두 블랙잭인 경우
- 딜러와 플레이어 모두 같은 숫자인 경우

다음은 플레이어의 **패배 조건**이다.

- 플레이어의 카드 합이 21점을 넘은 경우
- 플레이어의 카드 합이 딜러의 카드 합보다 적은 경우



### 딜러

게임을 시작하면 딜러는 두 장의 카드를 지급받는다.

만약 두 카드의 합이 16점 이하라면 반드시 1장의 카드를 추가로 뽑아야 한다.

패의 합이 17점 이상이라면, 딜러는 추가로 카드를 받을 수 없다.

딜러의 카드 합이 21점을 넘는다면, 플레이어들은 패와 상관없이 승리하여 배팅 금액을 받는다.(위의 플레이어 : 승리조건)



### 배팅

각 플레이어는 게임을 시작할 때 배팅 금액을 정해야 한다.

만약 처음 받은 두 장의 카드 합이 21이라면, 배팅 금액의 1.5배를 딜러에게 받는다.

만약 플레이어가 승리한 경우, 배팅 금액의 2배를 딜러에게 받는다.

만약 플레이어와 딜러가 비긴 경우, 배팅 금액만큼 딜러에게 돌려받는다.

만약 플레이어가 진 경우, 배팅 금액을 잃는다.





## 2. 기능 요구사항 (TO-DO)



**메인 클래스 개발**

- 블랙잭 클래스를 선언한다.
- 블랙잭 클래스의 게임 메서드를 호출한다.



**블랙잭 클래스**

- 싱글톤 구조로 설계하여 중복 호출되지 않도록 한다.
- 딜러와 플레이어 객체를 인스턴스 변수로 가지며, 특히 플레이어는 배열 대신 List로 구현한다.
- 블랙잭을 시작하면 호출해야 할 메서드 목록은 아래와 같다.
  - 이름 저장 : 이름을 입력받고 유저 리스트에 저장. 
  - 게임 진행
  - 게임 결과 출력 : 최종 수익 출력
- 게임 진행 메서드의 흐름은 다음과 같다.
  - 리스트의 각 플레이어 객체에 대해, 배팅 금액을 확인하는 메서드를 호출한다.
  - 딜러 객체와 플레이어 객체 리스트에 대해 2장씩 드로우 메서드를 호출한다.
  - 딜러 객체와 플레이어 객체 리스트에 대해 출력 메서드를 호출한다.
  - 플레이어 객체 리스트를 순회하며 업데이트(패 추가 드로우 여부 확인) 루프를 돈다.
  - 플레이어 순회가 끝나면, 딜러 객체에 대해 업데이트(패 드로우)를 수행한다.
  - 최종 결과를 조회하고, 배팅 결과를 각 유저별로 계산/출력해준다.



**카드 객체군**

- 카드 클래스 : 카드 한 장에 해당하는 정보를 가지고, 몇가지 기능을 추가로 가지고 있다.
  
  - 점수 계산 메서드
  - 보너스 점수(Ace 10점 추가가능) 계산 메서드
- 비교 연산 메서드
  - hashCode 메서드
  - toString 메서드
  
- 카드팩토리 클래스 : 트럼프카드 한 벌을 생성하는 메서드를 가지고 있다. 정적으로 구현된다.

  > 원래 기획은 카드팩토리 클래스에서 하나의 덱을 관리하면서, 카드를 뽑는(리스트에서 삭제해주는) 기능을 추가로 가지도록 하는 것이었다.
  >
  > 그러나 카드를 뽑을 때 pop하는 식으로 구현하면, 이후 (본 프로젝트 요구사항은 벗어나지만) 게임을 다시 실행하는 등의 상황에서 재활용이 어려울 수 있다는 생각이 들었다.(만약 그러한 경우, 한번의 셔플만 실행하는 게 더 효과적일지도 모른다.)
  > 더하여 카드팩토리 클래스에서의 create 메서드가 Collections.unmofiableList로 설정되어 return되므로, 리스트가 빌 때까지 pop하는 것은 의도되지 않은 동작으로 봐야한다.
  >
  > 그러한 이유로, 실제 카드뽑기 로직은 블랙잭 객체에 부여하고, 여기서는 순수하게 카드를 만드는 역할만을 수행하도록 설계한다. 다만 카드의 목록을 생성해 리턴해줄때 셔플을 거치도록 설계를 수정하여, 실제 블랙잭 클래스에서는 섞여있는 덱에서 하나씩 순회하며 카드를 뽑는 로직만 구현하도록 하였다.

  - 덱 생성 메서드

- 심볼 Enum : 나열형으로 1~10, 킹, 퀸, 잭 등 카드의 번호를 저장한다. 몇 가지 메서드를 추가로 가지고 있다.

- 타입 Enum : 나열형으로 스페이드, 다이아몬드, 하트, 클럽의 4가지 타입을 저장한다.



**유저 객체군**

- 플레이어 클래스 : 딜러의 기능들을 포함하는 클래스. 기능 목록은 다음과 같다.
  - 카드 리스트(즉, 플레이어가 손에 쥔 패 목록)를 가지고 있다.
  - 메서드를 통해 카드를 뽑는 동작을 취할 수 있다.
  - 현재 가진 카드의 점수 합을 계산할 수 있다.
  - 현재 가진 패를 출력할 수 있다.
  - 게임 오버 여부(21점을 넘었는지, 다른 사람의 점수보다 높은지 등)를 인자를 통해 판단할 수 있다.
- 돈을 배팅할 경우, 돈을 건네는(현재 금액에서 빼고, 그만큼의 금액을 반환하는) 메서드를 가진다.
  - 배당금을 받을 경우, 돈을 받는(파라미터만큼 현재 금액에 추가하는) 메서드를 가진다.
  - 카드를 추가로 뽑을 지 확인해주는 클래스를 가진다. 이를 통해 상위 객체에서 카드를 추가해준다.
- 딜러 클래스 : 플레이어를 상속하여 추가적인 기능을 구현한 클래스. 기능 목록은 다음과 같다.
  - 카드를 추가로 뽑을 지 물어보는 대신, 자신의 패 상황에 따라 뽑을 카드를 결정하도록 오버라이딩.
  - 생성자에서 상위 생성자를 호출(이름은 딜러, 금액은 0으로)

**기타 기능 객체/Enum**

- Message 클래스 : 블랙잭을 실행하면서 출력되는 메세지와 메서드들을 상수로 저장한다.
  - 입력/출력, 기타 메세지를 상수로 모아서 관리를 용이하게 한다.
  - 몇몇 정형화된 문자열 출력을 정적 메서드로 만들어, 인자로 이름을 받은 후 이름+메세지를 출력해준다. 
  - 구상시에는 싱글톤이나 열거형으로도 생각했지만, 일단 static 메서드와 필드를 가지는 클래스로 구현하였다. 
  - **이후 수정사항 기재**.



**예외처리**(꼭 문서화 작업때 @exception 달아주기!!)

- 이름 입력 예외처리 [2주차 프로젝트 조건 활용]
- 배팅 금액 입력 예외처리
- 추가 드로우 입력(플레이어 클래스) 예외처리
- (추가구현) 더 뽑을 카드가 없는 경우



## 3. 예외처리 세부사항 및 참고사항

**예외처리할 부분**

- 이름의 길이/입력제한

  - 이름은 문자열이다.

  - 이름은 최소 1글자, 최대 5글자까지 가능하다.
  - 이름은 최소 1개 이상 입력되어야 한다.

- 배팅 금액의 입력제한
  - 배팅 금액은 정수이다.
  - 배팅 금액은 음수나 0이 될 수 없다.

- 추가 드로우 입력의 입력제한
  - 입력은 두 가지, y/n이라는 문자열만 허용된다.
